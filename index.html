<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Mini Rede — Dark/Light, Curtir e Postar</title>
  <style>
    :root{
      --bg: #ffffff;
      --card: #f7f7f9;
      --text: #111827;
      --muted: #6b7280;
      --accent: #2563eb;
      --radius: 12px;
      --glass: rgba(255,255,255,0.6);
    }
    .dark{
      --bg: #0b1220;
      --card: #081226;
      --text: #e6eef8;
      --muted: #9aa8bd;
      --accent: #60a5fa;
      --glass: rgba(255,255,255,0.03);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:radial-gradient(1200px 800px at 10% 10%, rgba(37,99,235,0.06), transparent), var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:24px;
      transition:background .3s, color .2s;
    }

    .wrap{max-width:1000px;margin:0 auto;display:grid;grid-template-columns:1fr 340px;gap:20px}
    @media (max-width:900px){.wrap{grid-template-columns:1fr}}

    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    header h1{font-size:20px;margin:0}
    header p{margin:0;color:var(--muted);font-size:13px}

    .card{background:linear-gradient(180deg,var(--card), rgba(0,0,0,0.02));padding:16px;border-radius:var(--radius);box-shadow:0 6px 18px rgba(2,6,23,0.06);backdrop-filter: blur(6px)}

    /* Composer */
    form.composer{display:flex;flex-direction:column;gap:8px}
    textarea{resize:vertical;min-height:80px;max-height:300px;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--text)}
    .row{display:flex;gap:8px;align-items:center}
    .btn{padding:8px 12px;border-radius:10px;border:0;background:var(--accent);color:white;cursor:pointer;font-weight:600}
    .btn.secondary{background:transparent;color:var(--text);border:1px solid rgba(0,0,0,0.06)}

    /* feed */
    .feed{display:flex;flex-direction:column;gap:12px}
    .post{display:block;padding:12px;border-radius:10px;background:var(--glass);border:1px solid rgba(0,0,0,0.04)}
    .post .meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
    .post .content{white-space:pre-wrap;color:var(--text)}

    .like-btn{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:0;background:transparent;cursor:pointer}
    .like-btn .heart{font-size:16px}

    /* sidebar */
    .sidebar h3{margin-top:0}
    .toggle{display:inline-flex;align-items:center;gap:8px;padding:6px;border-radius:999px;border:1px solid rgba(0,0,0,0.06);cursor:pointer}

    footer{margin-top:22px;color:var(--muted);font-size:13px;text-align:center}

    /* small touches */
    .pill{padding:6px 10px;background:rgba(0,0,0,0.04);border-radius:999px;font-size:13px}

  </style>
</head>
<body>
  <div class="wrap">
    <main>
      <header>
        <div>
          <h1>Mini Rede</h1>
          <p>Crie posts, curta e troque entre modos.</p>
        </div>
        <div class="pill">Responsivo • JS</div>
      </header>

      <section class="card">
        <form id="composer" class="composer" aria-label="Criar novo post">
          <label for="postText" style="font-weight:600">Novo post</label>
          <textarea id="postText" placeholder="O que está acontecendo?" required></textarea>
          <div class="row" style="justify-content:space-between">
            <div style="display:flex;gap:8px;align-items:center">
              <button type="button" id="clearBtn" class="btn secondary">Limpar</button>
              <small style="color:var(--muted)">Máx 1000 caracteres</small>
            </div>
            <div>
              <button type="submit" class="btn" id="postBtn">Postar</button>
            </div>
          </div>
        </form>
      </section>

      <section style="margin-top:14px">
        <div id="feed" class="feed" aria-live="polite">
          <!-- posts serão inseridos aqui -->
        </div>
      </section>

      <footer>
        Feito com ♥ — Peça alterações se quiser mais recursos (persistência, edição, etc.)
      </footer>
    </main>

    <aside class="sidebar">
      <div class="card">
        <h3>Configurações</h3>
        <div style="display:flex;flex-direction:column;gap:10px;margin-top:8px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong>Tema</strong>
              <div style="color:var(--muted);font-size:13px">Alterne entre claro e escuro</div>
            </div>
            <button id="themeToggle" class="toggle" aria-pressed="false">Modo escuro</button>
          </div>

          <div>
            <strong>Sobre curtidas</strong>
            <div style="color:var(--muted);font-size:13px">Cada post tem seu contador. Curtir não exige login (local somente).</div>
          </div>
        </div>
      </div>

      <div style="height:12px"></div>

      <div class="card">
        <h3>Atalhos</h3>
        <ol style="color:var(--muted)">
          <li>Ctrl/Cmd + Enter → Postar</li>
          <li>Esc → Limpar composer</li>
        </ol>
      </div>
    </aside>
  </div>

  <script>
    // --- helpers ---
    const $ = (sel, el=document) => el.querySelector(sel);
    const qs = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    // Elementos
    const body = document.body;
    const themeToggle = $('#themeToggle');
    const composer = $('#composer');
    const textarea = $('#postText');
    const feed = $('#feed');
    const clearBtn = $('#clearBtn');

    // Estado (opcionalmente persistido)
    const LS_THEME = 'minirede_theme';
    const LS_POSTS = 'minirede_posts_v1';

    // Initialize theme from localStorage or prefers-color-scheme
    function initTheme(){
      const saved = localStorage.getItem(LS_THEME);
      if(saved){
        body.classList.toggle('dark', saved === 'dark');
      } else if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
        body.classList.add('dark');
      }
      updateThemeUI();
    }

    function updateThemeUI(){
      const isDark = body.classList.contains('dark');
      themeToggle.textContent = isDark ? 'Modo claro' : 'Modo escuro';
      themeToggle.setAttribute('aria-pressed', isDark);
    }

    themeToggle.addEventListener('click', ()=>{
      body.classList.toggle('dark');
      localStorage.setItem(LS_THEME, body.classList.contains('dark') ? 'dark' : 'light');
      updateThemeUI();
    });

    // --- Posts persistence ---
    function savePosts(posts){
      try{ localStorage.setItem(LS_POSTS, JSON.stringify(posts)); }catch(e){/* ignore */}
    }
    function loadPosts(){
      try{ return JSON.parse(localStorage.getItem(LS_POSTS) || '[]') }catch(e){return []}
    }

    // --- Render single post ---
    function createPostElement(post){
      const el = document.createElement('article');
      el.className = 'post card-post';
      el.dataset.id = post.id;

      const meta = document.createElement('div'); meta.className = 'meta';
      const left = document.createElement('div');
      left.innerHTML = `<strong>Você</strong> <div style="color:var(--muted);font-size:12px">${new Date(post.createdAt).toLocaleString()}</div>`;
      const right = document.createElement('div');

      const likeBtn = document.createElement('button');
      likeBtn.className = 'like-btn';
      likeBtn.setAttribute('aria-label', 'Curtir post');
      likeBtn.innerHTML = `<span class="heart">❤</span> <span class="count">${post.likes}</span>`;
      likeBtn.addEventListener('click', ()=>{
        post.likes = (post.likes || 0) + 1;
        likeBtn.querySelector('.count').textContent = post.likes;
        // persist
        const posts = loadPosts();
        const idx = posts.findIndex(p => p.id === post.id);
        if(idx > -1){ posts[idx].likes = post.likes; savePosts(posts); }
      });

      right.appendChild(likeBtn);
      meta.appendChild(left); meta.appendChild(right);

      const content = document.createElement('div'); content.className = 'content';
      content.textContent = post.text;

      el.appendChild(meta);
      el.appendChild(content);

      return el;
    }

    // Render all posts loaded from storage
    function renderPosts(){
      feed.innerHTML = '';
      const posts = loadPosts().sort((a,b)=>b.createdAt - a.createdAt);
      if(posts.length === 0){
        const empty = document.createElement('div'); empty.style.color = 'var(--muted)'; empty.textContent = 'Nenhum post ainda — seja o primeiro!';
        feed.appendChild(empty);
        return;
      }
      posts.forEach(p => feed.appendChild(createPostElement(p)));
    }

    // --- Composer handlers ---
    composer.addEventListener('submit', (e)=>{
      e.preventDefault();
      postCurrent();
    });

    function postCurrent(){
      const text = textarea.value.trim();
      if(!text) return;
      const posts = loadPosts();
      const post = { id: 'p_'+Date.now(), text, createdAt: Date.now(), likes: 0 };
      posts.push(post);
      savePosts(posts);
      textarea.value = '';
      renderPosts();
      textarea.focus();
    }

    clearBtn.addEventListener('click', ()=> textarea.value = '');

    // keyboard shortcuts
    textarea.addEventListener('keydown', (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key === 'Enter'){
        e.preventDefault(); postCurrent();
      } else if(e.key === 'Escape'){
        textarea.value = '';
      }
    });

    // init
    initTheme();
    renderPosts();

    // Expose for debugging if needed
    window.MiniRede = { renderPosts, loadPosts };
  </script>
</body>
</html>
